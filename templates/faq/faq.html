{% extends "base.html" %}
{% load i18n static phones %}

{% block title %}{% trans "FAQ — Диагностика мотора" %}{% endblock %}

{# SEO: структурированные данные FAQPage #}
{% block seo_jsonld %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {% for f in faqs %}
    {
      "@type": "Question",
      "name": {{ f.question|escapejs }},
      "acceptedAnswer": { "@type": "Answer", "text": {{ f.answer|linebreaksbr|escapejs }} }
    }{% if not forloop.last %},{% endif %}
    {% empty %}
    {
      "@type": "Question",
      "name": "Сколько стоит диагностика мотора?",
      "acceptedAnswer": { "@type": "Answer", "text": "Базовая диагностика — от 700 сом. Точную стоимость назовём после бесплатной первичной консультации." }
    }
    {% endfor %}
  ]
}
</script>
{% endblock %}

{% block content %}
  {# Хлебные крошки + «Назад» #}
  <nav class="max-w-6xl mx-auto mb-6 flex items-center justify-between text-sm text-neutral-400">
    <div class="space-x-2">
      <a href="{% url 'home' %}" class="hover:text-white">{% trans "Главная" %}</a>
      <span class="opacity-50">/</span>
      <span class="text-neutral-200">{% trans "FAQ" %}</span>
    </div>
    <button type="button"
            class="px-3 py-1.5 rounded-md border border-neutral-700 hover:bg-neutral-800 text-neutral-200"
            onclick="history.length>1?history.back():window.location.assign('{% url 'home' %}')">
      {% trans "Назад" %}
    </button>
  </nav>

  {# Хиро #}
  <section class="max-w-6xl mx-auto mb-8">
    <div class="rounded-2xl border border-neutral-800 bg-neutral-900/30 p-6 md:p-8">
      <h1 class="text-2xl md:text-3xl font-semibold text-white mb-2">
        {% trans "FAQ — Диагностика мотора" %}
      </h1>
      <p class="text-neutral-300">
        {% trans "Собрали ответы на частые вопросы о диагностике двигателя, сроках и стоимости. Если не нашли нужное — напишите нам в WhatsApp, поможем за пару минут." %}
      </p>
    </div>
  </section>

  <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
    {# Левая колонка — аккордеон #}
    <section class="md:col-span-2">
      <div class="divide-y divide-neutral-800 rounded-2xl border border-neutral-800 overflow-hidden">
        {% if faqs %}
          {% for f in faqs %}
            <details class="group bg-neutral-900/30 open:bg-neutral-900">
              <summary class="marker-none cursor-pointer list-none px-5 py-4 flex items-center justify-between gap-4">
                <h3 class="text-base md:text-lg text-white">{{ f.question }}</h3>
                <svg class="shrink-0 w-5 h-5 text-neutral-400 group-open:rotate-180 transition"
                     viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd"
                        d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z"
                        clip-rule="evenodd" />
                </svg>
              </summary>
              <div class="px-5 pb-5 pt-0 text-neutral-300 leading-relaxed">
                {{ f.answer|linebreaks }}
              </div>
            </details>
          {% endfor %}
        {% else %}
          {# fallback — три примера #}
          <details class="group bg-neutral-900/30 open:bg-neutral-900">
            <summary class="marker-none cursor-pointer list-none px-5 py-4 flex items-center justify-between gap-4">
              <h3 class="text-base md:text-lg text-white">{% trans "Сколько стоит диагностика мотора?" %}</h3>
              <svg class="shrink-0 w-5 h-5 text-neutral-400 group-open:rotate-180 transition" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"/></svg>
            </summary>
            <div class="px-5 pb-5 pt-0 text-neutral-300">
              {% trans "Базовая диагностика — от 1500 сом. Итог зависит от модели двигателя и перечня проверок. Точную стоимость назовём после осмотра." %}
            </div>
          </details>

          <details class="group bg-neutral-900/30 open:bg-neutral-900">
            <summary class="marker-none cursor-pointer list-none px-5 py-4 flex items-center justify-between gap-4">
              <h3 class="text-base md:text-lg text-white">{% trans "Сколько времени занимает?" %}</h3>
              <svg class="shrink-0 w-5 h-5 text-neutral-400 group-open:rotate-180 transition" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"/></svg>
            </summary>
            <div class="px-5 pb-5 pt-0 text-neutral-300">
              {% trans "Обычно 40–90 минут. При сложных случаях — до 2–3 часов с тест-драйвом и повторными проверками." %}
            </div>
          </details>

          <details class="group bg-neutral-900/30 open:bg-neutral-900">
            <summary class="marker-none cursor-pointer list-none px-5 py-4 flex items-center justify-between gap-4">
              <h3 class="text-base md:text-lg text-white">{% trans "Нужно ли записываться заранее?" %}</h3>
              <svg class="shrink-0 w-5 h-5 text-neutral-400 group-open:rotate-180 transition" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" clip-rule="evenodd"/></svg>
            </summary>
            <div class="px-5 pb-5 pt-0 text-neutral-300">
              {% trans "Да, так мы точно зарезервируем пост и диагноста. В экстренных случаях найдём окошко в день обращения." %}
            </div>
          </details>
        {% endif %}
      </div>
    </section>

    {# Правая колонка — «не нашли ответ» + быстрые контакты #}
    <aside class="space-y-6">
      <div class="rounded-2xl border border-neutral-800 bg-neutral-900/30 p-5">
        <h3 class="text-white font-semibold mb-2">{% trans "Не нашли ответ?" %}</h3>
        <p class="text-neutral-300 mb-4">
          {% trans "Напишите нам — ответим в течение нескольких минут и сориентируем по стоимости." %}
        </p>
        <div class="flex flex-col gap-3">
          {% if SITESET.whatsapp_link %}
          <a href="{{ SITESET.whatsapp_link }}"
             class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-green-500 text-black font-medium hover:brightness-110"
             target="_blank" rel="noopener">
            <span>WhatsApp</span>
          </a>
          {% endif %}
          <a href="tel:{{ SITESET.phone_e164 }}"
             class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg border border-neutral-700 text-white hover:bg-neutral-800">
            <span>{% trans "Позвонить" %} {{ SITESET.phone_e164|pretty_phone }}</span>
          </a>
        </div>
      </div>

      <div class="rounded-2xl border border-neutral-800 bg-neutral-900/30 p-5">
        <h3 class="text-white font-semibold mb-2">{% trans "Подсказка" %}</h3>
        <p class="text-neutral-300">
          {% trans "Диагностика — приоритет: она экономит бюджет ремонта. Мы фиксируем результаты и объясняем простыми словами." %}
        </p>
      </div>
    </aside>
  </div>

  {# Плавающий бар для мобильных #}
  <div class="fixed sm:hidden bottom-4 left-1/2 -translate-x-1/2 z-40 flex gap-3">
    {% if SITESET.whatsapp_link %}
    <a href="{{ SITESET.whatsapp_link }}"
       class="px-4 py-3 rounded-full bg-white text-black font-medium shadow-lg">WhatsApp</a>
    {% endif %}
    <a href="tel:{{ SITESET.phone_e164 }}"
       class="px-4 py-3 rounded-full bg-neutral-800 border border-neutral-700 text-white shadow-lg">{% trans "Позвонить" %}</a>
  </div>
{% endblock %}
